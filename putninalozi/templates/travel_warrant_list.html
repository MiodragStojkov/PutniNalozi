{% extends "layout.html" %}
{% block content %}
{% if current_user.authorization != 'c_user' %}
  <a class="btn btn-info btn-sm m-1" href="{{ url_for('travel_warrants.register_tw') }}">Kreiranje Novog Putnog Naloga</a>
{% endif %}
<hr>
<table id="data" border="1" class="table table-striped">
  {% if current_user.authorization == 's_admin' %}
    <thead>
      <tr id="header">
        <th>Br</th>
        <th>Kompanija</th>
        <th>Zaposleni</th>
        <th>Transport</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for warrant in warrants %}
        <tr>
          <td> <a class="mr-2" href="{{ url_for('travel_warrants.travel_warrant_profile', warrant_id=warrant.travel_warrant_id) }}" title="Edit Travel Warrant"> {{ warrant.travel_warrant_id }} </a> </td>
          <td> {{ warrant.travelwarrant_company.companyname }} </td>
          <td> {{ warrant.travelwarrant_user.name }} {{ warrant.travelwarrant_user.surname }} </td>
          <td> {{ warrant.other }} {{ warrant.personal_type }} {{ warrant.travelwarrant_vehicle.vehicle_type }} <br> {{warrant.travelwarrant_vehicle.vehicle_brand}} <br> {{warrant.travelwarrant_vehicle.vehicle_registration}} </td>
          <td> {{ warrant.status }} </td>
        </tr>
      {% endfor %}
    </tbody>
  {% elif current_user.authorization == 'c_admin' %}
    <thead>
      <tr id="header">
        <th>Br</th>
        <th>Zaposleni</th>
        <th>Transport</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for warrant in warrants %}
        {% if current_user.user_company.id == warrant.travelwarrant_company.id %}
          <tr>
            <td> <a class="mr-2" href="{{ url_for('travel_warrants.travel_warrant_profile', warrant_id=warrant.travel_warrant_id) }}" title="Edit Travel Warrant"> {{ warrant.travel_warrant_id }} </a> </td>
            <td> {{ warrant.travelwarrant_user.name }} {{ warrant.travelwarrant_user.surname}} </td>
            <td> {{ warrant.other }} {{ warrant.personal_type }} {{ warrant.travelwarrant_vehicle.vehicle_type }} {{warrant.travelwarrant_vehicle.vehicle_brand}} {{warrant.travelwarrant_vehicle.vehicle_registration}} </td>
            <td> {{ warrant.status }} </td>
          </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  {% else %}
    <thead>
      <tr id="header">
        <th>Br</th>
        <th>Zaposleni</th>
        <th>Transport</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for warrant in warrants %}
        {% if current_user.id == warrant.travelwarrant_user.id %}
          <tr>
            <td> <a class="mr-2" href="{{ url_for('travel_warrants.travel_warrant_profile', warrant_id=warrant.travel_warrant_id) }}" title="Edit Travel Warrant"> {{ warrant.travel_warrant_id }} </a> </td>
            <td> {{ warrant.travelwarrant_user.name }} {{ warrant.travelwarrant_user.surname}} </td>
            <td> {{ warrant.other }} {{ warrant.personal_type }} {{ warrant.travelwarrant_vehicle.vehicle_type }} {{warrant.travelwarrant_vehicle.vehicle_brand}} {{warrant.travelwarrant_vehicle.vehicle_registration}} </td>
            <td> {{ warrant.status }} </td>
          </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  {% endif %}
</table>

{% endblock content%}

{% block scripts %}
  <script>
    $(document).ready(function () {
      $('#data').DataTable();
    });
  </script>
{% endblock %}
